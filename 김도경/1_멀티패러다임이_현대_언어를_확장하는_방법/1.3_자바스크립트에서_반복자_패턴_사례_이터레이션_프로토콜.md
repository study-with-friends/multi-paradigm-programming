# 1.3 ìë°”ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ë°˜ë³µì íŒ¨í„´ ì‚¬ë¡€: ì´í„°ë ˆì´ì…˜ í”„ë¡œí† ì½œ

> **ì´í„°ë ˆì´ì…˜ í”„ë¡œí† ì½œì€ ìë°”ìŠ¤í¬ë¦½íŠ¸ì˜ ê·œì•½ì´ë‹¤. ì–´ë–¤ ê°ì²´ê°€ ì´í„°ëŸ¬ë¸”ì¸ì§€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê·œì¹™ì„ ì´ì•¼ê¸°í•œë‹¤.**
> 

## 1.3.1 ì´í„°ë ˆì´í„°ì™€ ì´í„°ëŸ¬ë¸”

> ê°ì²´ê°€ ì´í„°ë ˆì´í„°ë¥¼ ë°˜í™˜í•˜ëŠ” `[Symbol.iterator]` ë©”ì„œë“œë¥¼ ê°€ì§€ê³  ìˆë‹¤ë©´ ì´ ê°ì²´ëŠ” ì´í„°ëŸ¬ë¸”ì´ë‹¤.
> 

ì´í„°ëŸ¬ë¸” ê°ì²´ëŠ” 

- ì´í„°ë ˆì´í„°ë¥¼ í†µí•´ ìì‹ ì´ ê°€ì§„ ìš”ì†Œë“¤ì„ ìˆœíšŒí•  ìˆ˜ ìˆë‹¤.
- ì•ì„œ ë§í•œ ë°˜ë³µì íŒ¨í„´ì˜ ëª¨ë“  íŠ¹ì„±ì„ ê°–ì¶”ê³  ìˆë‹¤.

### ì´í„°ë ˆì´í„°

ìì—°ìˆ˜ë¥¼ ìƒì„±í•˜ëŠ” ì´í„°ë ˆì´í„°ë¥¼ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ë¥¼ ì œë„ˆë ˆì´í„°ê°€ ì•„ë‹Œ ì¼ë°˜ í•¨ìˆ˜ë¡œ ë§Œë“¤ì–´ë³´ì.

```
function naturals(end = Infinity): Iterator<number> {
    let n = 1;
    return {
        next(): IteratorResult<number> {
            return n <= end
                ? { value: n++, done: false }
                : { value: undefined, done: true }
        }
    }
}
```

ì´ í•¨ìˆ˜ë¥¼ í†µí•´ ë§Œë“  ì´í„°ë ˆì´í„°(?)ë¥¼ forâ€¦of ë¬¸ìœ¼ë¡œ ìˆœíšŒí•˜ë ¤ í•˜ë©´ ì–´ë–»ê²Œ ë ê¹Œ?

```
const iterator = naturals()

for (const num of iterator) {
    //              ^^^
    // Type 'Iterator<number, any, any>' must have a '[Symbol.iterator]()' method that returns an iterator.
    console.log(num)
}
```

ë‹¤ìŒê³¼ ê°™ì´ ì—ëŸ¬ê°€ í‘œì‹œëœë‹¤.

ì´ë¥¼ ì œëŒ€ë¡œ í‘œì‹œí•˜ê¸° ìœ„í•´ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì´ Symbol.iterator ë©”ì„œë“œë¥¼ ì¶”ê°€í•´ ì£¼ì–´ì•¼ í•œë‹¤.

```tsx
function naturals(end = Infinity): IterableIterator<number> {
    let n = 1;
    return {
        next(): IteratorResult<number> {
            return n <= end
                ? { value: n++, done: false }
                : { value: undefined, done: true }
        },
        // ë©”ì„œë“œ ì¶”ê°€
        [Symbol.iterator]() {
            return this; // ìê¸° ìì‹ ì„ ë°˜í™˜í•œë‹¤. ìê¸° ìì‹ ì€ next() ë©”ì„œë“œë¥¼ ê°€ì§„ ì´í„°ë ˆì´í„°
        }
    }
}

const iterator = naturals(3)

for (const num of iterator) {
    console.log(num)
}
```

ì´ì œ forâ€¦of ë¬¸ì„ ì‚¬ìš©í•˜ì—¬ natural() í•¨ìˆ˜ê°€ ìƒì„±í•˜ëŠ” ìì—°ìˆ˜ë¥¼ ìˆœíšŒí•  ìˆ˜ ìˆë‹¤.

- ì´í„°ëŸ¬ë¸” ê°ì²´ì˜ [Symbol.iterator]() ë©”ì„œë“œê°€ í˜¸ì¶œë˜ì–´ ì´í„°ë ˆì´í„°ë¥¼ ë°˜í™˜
- forâ€¦of ë¬¸ì´ ìë™ìœ¼ë¡œ next() ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ì—¬ ìì—°ìˆ˜ë¥¼ ìˆœíšŒ

ë°˜í™˜ íƒ€ì… IterableIteratorëŠ” **ì´í„°ëŸ¬ë¸”ì´ì ë™ì‹œì— ì´í„°ë ˆì´í„°**

- { value, done } í˜•íƒœì˜ ê°ì²´ë¥¼ ë°˜í™˜í•˜ëŠ” next() ë©”ì„œë“œë¥¼ ê°€ì§€ê³  ìˆê¸° ë•Œë¬¸ì— **ì´í„°ë ˆì´í„°**
- [Symbol.iterator]() ë©”ì„œë“œë¥¼ ê°€ì§€ê³  ìˆê³ , ì´ ë©”ì„œë“œê°€ ì´í„°ë ˆì´í„°ë¥¼ ë°˜í™˜í•˜ë¯€ë¡œ **ì´í„°ëŸ¬ë¸”**

### íƒ€ì… wrap up

```tsx
interface IteratorYieldResult<T> {
  done?: false;
  value: T;
}

interface IteratorReturnResult<T> {
  done: true;
  value: undefined;
}

interface Iterator<T> {
  next(): IteratorYieldResult<T> | IteratorReturnResult<T>
}

interface Iterable<T> {
  [Symbol.iterator](): Iterator<T>
}
```

### **ì´í„°ë ˆì´ì…˜ í”„ë¡œí† ì½œ**

> ì´í„°ë ˆì´ì…˜ì€ ìë°”ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ì–´ë–¤ ê°’ì´ **ë°˜ë³µ ê°€ëŠ¥**í•œì§€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê·œì•½ì´ë‹¤. ì´í„°ëŸ¬ë¸” í”„ë¡œí† ì½œê³¼ ì´í„°ë ˆì´í„° í”„ë¡œí† ì½œë¡œ ë‚˜ë‰œë‹¤.
> 

ì´í„°ë ˆì´ì…˜ í”„ë¡œí† ì½œì„ ë”°ë¥´ëŠ” ê°’ì€ forâ€¦of ë¬¸, ì „ê°œ ì—°ì‚°ì ë“±ê³¼ í•¨ê»˜ ë™ì‘í•  ìˆ˜ ìˆë‹¤.

- ì´í„°ë ˆì´í„° í”„ë¡œí† ì½œ
    - **IteratorëŠ” { value, done } í˜•íƒœì˜ ê°ì²´ë¥¼ ë°˜í™˜í•˜ëŠ” next() ë©”ì„œë“œë¥¼ ê°€ì§„ ê°’**ì´ë‹¤.
- ì´í„°ëŸ¬ë¸” í”„ë¡œí† ì½œ
    - **Iterableì€ ì´í„°ë ˆì´í„°ë¥¼ ë°˜í™˜í•˜ëŠ” [Symbol.iterator]() ë©”ì„œë“œë¥¼ ê°€ì§„ ê°’**ì´ë‹¤.


> ğŸ’¡ ì´í„°ë ˆì´í„°ë©´ì„œ ì´í„°ëŸ¬ë¸”ì¸ ê°’ì´ ìˆë‚˜? â†’ ìˆë‹¤. ì œë„ˆë ˆì´í„° ê°ì²´



```tsx
function* gen () {
	yield 1
	yield 2
	yield 3
}

const g = gen()

g.next // ì¡´ì¬
g[Symbol.iterator] // ì¡´ì¬
```

**ì™œ?**

ì œë„ˆë ˆì´í„°ë¥¼ í†µí•´ ë§Œë“¤ì–´ì§„ ì œë„ˆë ˆì´í„° ê°ì²´ëŠ” **ë°”ë¡œ ìˆœíšŒê°€ ê°€ëŠ¥í•´ì•¼ í•˜ê¸° ë•Œë¬¸**.

```tsx
console.log(g.next()) // { value: 1, done: false }
console.log(g.next()) // { value: 2, done: false }

for (const num of g) {
  console.log(num)    // 3, 4, 5
}
```

forâ€¦of ë¬¸ì€ ë‚´ë¶€ì ìœ¼ë¡œ ì´ë ‡ê²Œ ë™ì‘

```tsx
for (const num of g) {
  console.log(num)    // 3, 4, 5
}

const iter = g[Symbol.iterator]()
let res = iter.next()
while(!res.done) {
  const value = result.value
  result = iter.next()
}
```

### ë‚´ì¥ ì´í„°ëŸ¬ë¸”

ìë°”ìŠ¤í¬ë¦½íŠ¸ì˜ ë‚´ì¥ ì´í„°ëŸ¬ë¸”ì— ëŒ€í•´ ì•Œì•„ë³´ì

**Array**

**Set**

**Map**

map.entries()ë‚˜ map.values(), map.keys() ë©”ì„œë“œëŠ” Map ê°ì²´ì˜ ë°ì´í„°ë¥¼ IterableIteratorë¡œ ë°˜í™˜í•œë‹¤. ì´ëŠ”, next() ë©”ì„œë“œë¥¼ í†µí•´ì„œë„ ìˆœíšŒ ê°€ëŠ¥í•˜ê³ , forâ€¦of ë¬¸ì„ í†µí•´ì„œ ë‚˜ë¨¸ì§€ ê°’ë“¤ì„ ìˆœíšŒí•  ìˆ˜ ìˆë‹¤ëŠ” ëœ»ì´ë‹¤.

```tsx
const map = new Map([['a', 1], ['b', 2], ['c', 3]])

const mapEntries = map.entries()

// next()ë¥¼ ì‚¬ìš©í•´ì„œ ìˆœíšŒ ê°€ëŠ¥
console.log(mapEntries.next()) // { value: ['a', 1], done: false }

// for...ofë¥¼ ì‚¬ìš©í•˜ì—¬ ìˆœíšŒ ê°€ëŠ¥
for (const entry of mapEntries) {
    console.log(entry) // ['b', 2], ['c', 3]
}
```

## 1.3.2 ì–¸ì–´ì™€ ì´í„°ëŸ¬ë¸”ì˜ ìƒí˜¸ì‘ìš©

ì´í„°ëŸ¬ë¸”ì€ ì–¸ì–´ì˜ ë‹¤ì–‘í•œ ê¸°ëŠ¥ê³¼ ìƒí˜¸ì‘ìš©í•˜ë©° ë™ì‘.

> ì „ê°œ ì—°ì‚°ìì™€ êµ¬ì¡° ë¶„í•´ í• ë‹¹ì€ ì´í„°ëŸ¬ë¸” í”„ë¡œí† ì½œì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ì™€ ì½”ë“œë¥¼ ë”ìš± íš¨ê³¼ì ìœ¼ë¡œ ë‹¤ë£¨ëŠ” ë°©ë²•ì„ ì œê³µí•œë‹¤.
> 

### ì „ê°œ ì—°ì‚°ìì™€ ì´í„°ëŸ¬ë¸”

> ì „ê°œ ì—°ì‚°ìëŠ” ì´í„°ëŸ¬ë¸” ê°ì²´ì˜ ëª¨ë“  ìš”ì†Œë¥¼ ê°œë³„ ìš”ì†Œë¡œ í™•ì¥í•˜ëŠ” ë° ì‚¬ìš©
> 

```tsx
const array = [1, 2, 3]
const array2 = [...array, 4, 5, 6] // [1,2,3,4,5,6]

const set = new Set([1, 2, 3])
const array = [...set]         // [1,2,3]
const array2 = Array.from(set) // [1,2,3] => [...set]ê³¼ ë™ì¼
```

### êµ¬ì¡° ë¶„í•´ í• ë‹¹ê³¼ ì´í„°ëŸ¬ë¸”

> êµ¬ì¡° ë¶„í•´ í• ë‹¹ì€ ì´í„°ëŸ¬ë¸” ê°ì²´ì˜ ìš”ì†Œë“¤ì„ ê°œë³„ ë³€ìˆ˜ì— í• ë‹¹í•˜ëŠ” ë°©ë²•
> 

```tsx
const array = [1,2,3]
const [first, second, third] = array

console.log(first)
console.log(second)
console.log(third)
```

```tsx
const array = [1,2,3, 4]
const [head, ...tail] = array

console.log(head)
console.log(tail)
```

### ì‚¬ìš©ì ì •ì˜ ì´í„°ëŸ¬ë¸”ê³¼ ì „ê°œ ì—°ì‚°ì

ìš°ë¦¬ê°€ ë§Œë“ , ì‚¬ìš©ì ì •ì˜ ì´í„°ëŸ¬ë¸”ì„ ë°˜í™˜í•˜ëŠ” naturals() í•¨ìˆ˜ë¥¼ ì „ê°œ ì—°ì‚°ìë¡œ ì‚¬ìš©

```tsx
const array = [0, ...naturals(3)]
console.log(array) // [0, 1, 2, 3]
```

### ë°˜ë³µì íŒ¨í„´ê³¼ ì´í„°ë ˆì´ì…˜ í”„ë¡œí† ì½œ

ì´í„°ë ˆì´ì…˜ í”„ë¡œí† ì½œì„ ì‚¬ìš©í•´ì„œ ì „ê°œ ì—°ì‚°ìì™€ êµ¬ì¡° ë¶„í•´ í• ë‹¹ ë“±, ë°ì´í„°ì™€ ì½”ë“œë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ë‹¤ë£° ìˆ˜ ìˆëŠ” ë°©ë²•ë“¤ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ì´ëŠ” ë°˜ë³µì íŒ¨í„´ì˜ ë‹¤ìŒê³¼ ê°™ì€ íŠ¹ì§• ë•Œë¬¸ì´ë‹¤.

- ë°˜ë³µì íŒ¨í„´ì€ **ì»¬ë ‰ì…˜ì˜ ë‚´ë¶€ êµ¬ì¡°ë¥¼ ë…¸ì¶œí•˜ëŠ” ëŒ€ì‹  next() ê°™ì€ public ë©”ì„œë“œë¥¼ í†µí•´ ë‚´ë¶€ ì»¬ë ‰ì…˜ì— ì ‘ê·¼**
    - ì»¬ë ‰ì…˜ì˜ ì‹¤ì œ êµ¬ì¡°ë¥¼ ì¶”ìƒí™”í•´ì„œ **ë‹¤ì–‘í•œ ì»¬ë ‰ì…˜ ìŠ¤íƒ€ì¼ì˜ ë°ì´í„°ë¥¼ ì¼ê´€ëœ ë°©ì‹ìœ¼ë¡œ ìˆœíšŒí•  ìˆ˜ ìˆë‹¤.**
    - Array, Map, Set ë“± ì–´ë–¤ ìë£Œêµ¬ì¡°ì¸ì§€ëŠ” ì¤‘ìš”í•˜ì§€ ì•ŠìŒ

## 1.3.3 ì œë„ˆë ˆì´í„°ë¡œ ë§Œë“  ì´í„°ë ˆì´í„°ë„ ì´í„°ëŸ¬ë¸”

ì œë„ˆë ˆì´í„°ëŠ” ì´í„°ëŸ¬ë¸”ì´ì ì´í„°ë ˆì´í„°ë¥¼ ë°˜í™˜í•œë‹¤.

```tsx
// ì›ë³¸ -> ì´í„°ë ˆì´í„°ë¥¼ ë°›ì•„ ì´í„°ë ˆì´í„°ë¥¼ ë°˜í™˜. ì§€ì—° í‰ê°€ ê°€ëŠ¥
function map<A, B>(transform: (value: A) => B, iterator: Iterator<A>): Iterator<B> {
    return {
        next(): IteratorResult<B> {
            const { value, done } = iterator.next()
            return done
                ? { value, done }
                : { value: transform(value), done }
        }
    }
}

// ë³€ê²½ -> ì´í„°ë ˆì´í„°ê°€ ì•„ë‹Œ ì´í„°ëŸ¬ë¸”ì„ ë°˜í™˜í•œë‹¤.
function* map<A, B>(transform: (value: A) => B, iterable: Iterable<A>): IterableIterator<B> {
    for (const value of iterable) {
        yield transform(value)
    }
}
```

ë”°ë¼ì„œ .next(), [Symbol.iterator](), ì „ê°œ ì—°ì‚°ì ëª¨ë‘ í™œìš©ì´ ê°€ëŠ¥í•˜ë‹¤.

```tsx
const array = [1,2,3,4]
const mapped: IterableIterator<number> = map(x => x * 2, array)
const iterator = mapped[Symbol.iterator]()

// ì´í„°ë ˆì´í„°ì´ë¯€ë¡œ next()
console.log(mapped.next().value)
// ì´í„°ëŸ¬ë¸”ì´ë¯€ë¡œ [Symbol.iterator]()ë¡œ ì´í„°ë ˆì´í„° ë°˜í™˜
console.log(iterator.next().value)
// ì´í„°ëŸ¬ë¸”ì´ë¯€ë¡œ ì „ê°œ ì—°ì‚°ì ì‚¬ìš©
console.log([...iterator])
```

ì œë„ˆë ˆì´í„°ë¡œ ë§Œë“  ì´í„°ë ˆì´í„°ë„ ì´í„°ëŸ¬ë¸”ì„.

```tsx
function* map<A, B>(transform: (value: A) => B, iterable: Iterable<A>): IterableIterator<B> {
    for (const value of iterable) {
        yield transform(value)
    }
}

function* naturals(end = Infinity): IterableIterator<number> {
    let n = 1;

    while(n <= end) {
        yield n++
    }
}

let acc = 0
// map ì œë„ˆë ˆì´í„°ë¡œ ë§Œë“  ì´í„°ë ˆì´í„°ëŠ” ì´í„°ëŸ¬ë¸”ì´ë¯€ë¡œ for...ofë¡œ ìˆœíšŒ
for (const num of map((x) => x * 2, naturals(4))) {
    acc += num
}
console.log(acc)
```